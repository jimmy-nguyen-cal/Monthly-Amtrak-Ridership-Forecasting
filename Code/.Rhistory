# summary of the significance of the estimates
summary(fracdiff(arf, nar=1))
acf2(diff(arf), 20)
fit <- arima(diff(arf), c(p, 0, q))
fit <- arima(diff(arf), c(1, 0, 1))
res <- residuals(fit)
acf(res)
pacf(res)
qplot(sample = res)
sarima(diff(arf), 1,0,0) # AR(1) on growth rate
sarima(diff(arf), 1,0,0)
knitr::opts_chunk$set(echo = TRUE)
library(astsa)
library(tidyverse)
library(forecast)
library(fGarch)
library(fracdiff)
set.seed(506)
# examine residuals
res = resid( sarima(diff(log(gnp)), 1,0,0, details=FALSE)$fit )
acf2(res^2, 20)
# data
gnpr = diff(log(gnp))
# fit garch model
summary(gnpr.g <- garchFit(~arma(1,0) + garch(1,0), data = gnpr,trace =  FALSE))
# Garch plot
plot(gnpr.g, which  = 3)
# plotting data
plot(arf)
# plot the ACF and PACF
acf2(arf, 20)
# summary of the significance of the estimates
summary(fracdiff(arf, nar=1))
acf2(diff(arf), 20)
sarima(diff(arf), 1,0,0)
library(astsa)
library(readr)
library(forecast)
library(zoo)
library(xts)
library(pander)
library(tidyverse)
library(lubridate)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
# Load the data set from CSV file
df <- read_csv("~/Coding/Monthly-Amtrak-Ridership-Forecasting/Data/Amtrak Ridership Data.csv")
setwd("C:/Coding/USD-Classes/ADS-506 - Applied Time Series Analysis/Modules/Module 5 - Multivariate Time Series and ARCH Models/Assignment")
setwd("C:/Coding/Monthly-Amtrak-Ridership-Forecasting/Code")
library(astsa)
library(readr)
library(forecast)
library(zoo)
library(xts)
library(pander)
library(tidyverse)
library(lubridate)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
# Load the data set from CSV file
df <- read_csv("~/Coding/Monthly-Amtrak-Ridership-Forecasting/Data/Amtrak Ridership Data.csv")
library(astsa)
library(readr)
library(forecast)
library(zoo)
library(xts)
library(pander)
library(tidyverse)
library(lubridate)
library(arfima)
install.packages("arfima")
library(astsa)
library(readr)
library(forecast)
library(zoo)
library(xts)
library(pander)
library(tidyverse)
library(lubridate)
library(arfima)
library(tseries)
library(fGarch)
library(xts)
library(fracdiff)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
# Load the data set from CSV file
df <- read_csv("~/Coding/Monthly-Amtrak-Ridership-Forecasting/Data/Amtrak Ridership Data.csv")
setwd("C:/Coding/Monthly-Amtrak-Ridership-Forecasting/Code")
# Load the data set from CSV file
df <- read_csv("~/Coding/Monthly-Amtrak-Ridership-Forecasting/Data/Amtrak Ridership Data.csv")
library(astsa)
library(readr)
library(forecast)
library(zoo)
library(xts)
library(pander)
library(tidyverse)
library(lubridate)
library(arfima)
library(tseries)
library(fGarch)
library(xts)
library(fracdiff)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
# Load the data set from CSV file
df <- read_csv("~/Coding/Monthly-Amtrak-Ridership-Forecasting/Data/Amtrak Ridership Data.csv")
# Load the data set from CSV file
df <- read_csv("C:/Coding/Monthly-Amtrak-Ridership-Forecasting/Data/Amtrak Ridership Data.csv")
# Rename columns
names(df)[1] <- 'Dates'
names(df[2]) <- 'Number_of_Passengers'
# First 12 months in 1991
head(df, n = 12) %>%
pander(style = "grid", caption = "First 12 Months - 1991")
# Load the data set from CSV file
df <- read_csv("C:/Coding/Monthly-Amtrak-Ridership-Forecasting/Data/Amtrak Ridership Data.csv")
# Rename columns
names(df)[1] <- 'Dates'
names(df[2]) <- 'Number_of_Passengers'
# First 12 months in 1991
head(df, n = 12) %>%
pander(style = "grid", caption = "First 12 Months - 1991")
# Load the data set from CSV file
df <- read_csv("C:/Coding/Monthly-Amtrak-Ridership-Forecasting/Data/Amtrak Ridership Data.csv")
# Rename columns
names(df)[1] <- 'Dates'
names(df[2]) <- 'Number_of_Passengers'
# First 12 months in 1991
head(df, n = 12) %>%
pander(style = "grid", caption = "First 12 Months - 1991")
library(astsa)
library(readr)
library(forecast)
library(zoo)
library(xts)
library(pander)
library(tidyverse)
library(lubridate)
library(arfima)
library(tseries)
library(fGarch)
library(xts)
library(fracdiff)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(astsa)
library(readr)
library(forecast)
library(zoo)
library(xts)
library(pander)
library(tidyverse)
library(lubridate)
library(arfima)
library(tseries)
library(fGarch)
library(xts)
library(fracdiff)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
# Load the data set from CSV file
df <- read_csv("C:/Coding/Monthly-Amtrak-Ridership-Forecasting/Data/Amtrak Ridership Data.csv")
# Rename columns
names(df)[1] <- 'Dates'
names(df[2]) <- 'Number_of_Passengers'
# First 12 months in 1991
head(df, n = 12) %>%
pander(style = "grid", caption = "First 12 Months - 1991")
# convert to time series object
df<- ts(data = df[,2], start = c(1991,1),
end = c(2013,5), frequency = 12)
print("Starting Year and Month: ")
start(df)
print("Final Year and Month: ")
end(df)
# Make a quick time-series plot
plot(df, xlab = "Year", ylab = "Number of Passengers",
bty = "l", col = "grey41",
main = "Amtrak Ridership, 1991-2013")
# Trailing Average
ma.trailing <- rollmean(df, k = 12, align = "right")
# Centered-Average
ma.centered <- ma(df, order = 12)
# Original Data
plot(df, ylab = "Ridership", xlab = "Time",
bty = "l", xaxt = "n", col = 'grey41',
main = "Centered vs. Trailing Moving Average")
# Labels
axis(1, at = seq(1991, 2013.50, 1), labels = format(seq(1991, 2013.50, 1)))
# Centered average lines
lines(ma.centered, lwd = 2, col = 'red')
# trailing moving average
lines(ma.trailing, lwd = 2, lty = 2, col ='blue')
# legend
legend(1991,2800000, c("Ridership","Centered Moving Average",
"Trailing Moving Average"), lty=c(1,1,2),
lwd=c(1,2,2), bty = "n", col = c("grey41", 'red', 'blue'))
# Validation Data
nValid <- 36
# Training data
nTrain <- length(df) - nValid
# time window for training data
train.ts <- window(df, start = c(1991, 1), end = c(1991, nTrain))
# time window for validation data
valid.ts <- window(df, start = c(1991, nTrain + 1), end = c(1991, nTrain + nValid))
# trailing moving average
ma.trailing <- rollmean(train.ts, k = 12, align = "right")
# last trailing moving average
last.ma <- tail(ma.trailing, 1)
# prediction by trailing moving average
ma.trailing.pred <- ts(rep(last.ma, nValid), start = c(1991, nTrain + 1),
end = c(1991, nTrain + nValid), freq = 12)
# plot
plot(train.ts, ylim = c(1300000, 2800000), ylab = "Ridership",
xlab = "Time", bty="l", xaxt = "n", col = 'grey41',
xlim = c(1991,2013.50), main = "Forecasting with Trailing Moving Average")
# labels
axis(1, at = seq(1991, 2013.50, 1), labels = format(seq(1991, 2013.50, 1)))
# training data
lines(ma.trailing, lwd = 2, col = "blue")
# validation data
lines(valid.ts, col = 'blue')
# predictions
lines(ma.trailing.pred, lwd = 2, col = "blue", lty = 2)
#test the dataset for stationarity if stationary no need for differencing if not stationary the data will be differenced.
adf.test(df)
par(mfrow=c(2,2))
# Original
plot(df, xlab = "Year", ylab = "Number of Passengers",
main = "Original Amtrak Ridership, 1991-2013", col = 'grey41')
# lag-12 difference
plot(diff(df, lag = 12), xlab = "Year", ylab = "Lag-12",
main = "Lag-12 Difference", col = 'blue')
# lag-1 difference
plot(diff(df), xlab = "Year", ylab = "Lag-1",
main = "Lag-1 Difference", col = 'red')
# Double Differencing
plot(diff(diff(df, s = 12)), xlab = "Year", ylab = "Lag-12, then Lag-1",
main = "Twice-DIfferenced (Lag-12, Lag-1)", col = 1)
# remove trend and seasonality by doing double-differencing
diff_twice <- diff(diff(df, lag = 12), lag = 1)
# Number of validation data
nValid <- 36
# number of training data
nTrain <- length(diff_twice) - nValid
# specified time window for training data
train.ts <- window(diff_twice, start = c(1992, 2), end = c(1992, nTrain + 1))
# specified time window for validation data
valid.ts <- window(diff_twice, start = c(1992, nTrain + 2),
end = c(1992, nTrain + 1 + nValid))
# Additive, no trend, no seasonality model using a constant (learning rate) of 0.2
ses <- ets(train.ts, model = "ANN", alpha = 0.2)
# make predictions using model
ses.pred <- forecast(ses, h = nValid, level = 0)
# plot predictions
plot(ses.pred, ylab = "Ridership (Twice-Differenced)", xlab = "Time",
bty = "l", xaxt = "n", xlim = c(1991,2013.50), main = "Simple Exponential Smoother on
Double Differenced Data", flty = 2)
# labels
axis(1, at = seq(1991, 2013, 1), labels = format(seq(1991, 2013, 1)))
# validaiton data
lines(valid.ts)
# model from training and validation data
lines(ses.pred$fitted, lwd = 2, col = "blue")
library(astsa)
library(readr)
library(forecast)
library(zoo)
library(xts)
library(pander)
library(tidyverse)
library(lubridate)
library(arfima)
library(tseries)
library(fGarch)
library(xts)
library(fracdiff)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
# Load the data set from CSV file
df <- read_csv("C:/Coding/Monthly-Amtrak-Ridership-Forecasting/Data/Amtrak Ridership Data.csv")
# Rename columns
names(df)[1] <- 'Dates'
names(df[2]) <- 'Number_of_Passengers'
# First 12 months in 1991
head(df, n = 12) %>%
pander(style = "grid", caption = "First 12 Months - 1991")
# convert to time series object
df<- ts(data = df[,2], start = c(1991,1),
end = c(2013,5), frequency = 12)
print("Starting Year and Month: ")
start(df)
print("Final Year and Month: ")
end(df)
# Make a quick time-series plot
plot(df, xlab = "Year", ylab = "Number of Passengers",
bty = "l", col = "grey41",
main = "Amtrak Ridership, 1991-2013")
# Trailing Average
ma.trailing <- rollmean(df, k = 12, align = "right")
# Centered-Average
ma.centered <- ma(df, order = 12)
# Original Data
plot(df, ylab = "Ridership", xlab = "Time",
bty = "l", xaxt = "n", col = 'grey41',
main = "Centered vs. Trailing Moving Average")
# Labels
axis(1, at = seq(1991, 2013.50, 1), labels = format(seq(1991, 2013.50, 1)))
# Centered average lines
lines(ma.centered, lwd = 2, col = 'red')
# trailing moving average
lines(ma.trailing, lwd = 2, lty = 2, col ='blue')
# legend
legend(1991,2800000, c("Ridership","Centered Moving Average",
"Trailing Moving Average"), lty=c(1,1,2),
lwd=c(1,2,2), bty = "n", col = c("grey41", 'red', 'blue'))
# Validation Data
nValid <- 36
# Training data
nTrain <- length(df) - nValid
# time window for training data
train.ts <- window(df, start = c(1991, 1), end = c(1991, nTrain))
# time window for validation data
valid.ts <- window(df, start = c(1991, nTrain + 1), end = c(1991, nTrain + nValid))
# trailing moving average
ma.trailing <- rollmean(train.ts, k = 12, align = "right")
# last trailing moving average
last.ma <- tail(ma.trailing, 1)
# prediction by trailing moving average
ma.trailing.pred <- ts(rep(last.ma, nValid), start = c(1991, nTrain + 1),
end = c(1991, nTrain + nValid), freq = 12)
# plot
plot(train.ts, ylim = c(1300000, 2800000), ylab = "Ridership",
xlab = "Time", bty="l", xaxt = "n", col = 'grey41',
xlim = c(1991,2013.50), main = "Forecasting with Trailing Moving Average")
# labels
axis(1, at = seq(1991, 2013.50, 1), labels = format(seq(1991, 2013.50, 1)))
# training data
lines(ma.trailing, lwd = 2, col = "blue")
# validation data
lines(valid.ts, col = 'blue')
# predictions
lines(ma.trailing.pred, lwd = 2, col = "blue", lty = 2)
#test the dataset for stationarity if stationary
# no need for differencing if not stationary the data will be differenced.
adf.test(df)
par(mfrow=c(2,2))
# Original
plot(df, xlab = "Year", ylab = "Number of Passengers",
main = "Original Amtrak Ridership, 1991-2013", col = 'grey41')
# lag-12 difference
plot(diff(df, lag = 12), xlab = "Year", ylab = "Lag-12",
main = "Lag-12 Difference", col = 'blue')
# lag-1 difference
plot(diff(df), xlab = "Year", ylab = "Lag-1",
main = "Lag-1 Difference", col = 'red')
# Double Differencing
plot(diff(diff(df, s = 12)), xlab = "Year", ylab = "Lag-12, then Lag-1",
main = "Twice-DIfferenced (Lag-12, Lag-1)", col = 1)
# remove trend and seasonality by doing double-differencing
diff_twice <- diff(diff(df, lag = 12), lag = 1)
# Number of validation data
nValid <- 36
# number of training data
nTrain <- length(diff_twice) - nValid
# specified time window for training data
train.ts <- window(diff_twice, start = c(1992, 2), end = c(1992, nTrain + 1))
# specified time window for validation data
valid.ts <- window(diff_twice, start = c(1992, nTrain + 2),
end = c(1992, nTrain + 1 + nValid))
# Additive, no trend, no seasonality model using a constant (learning rate) of 0.2
ses <- ets(train.ts, model = "ANN", alpha = 0.2)
# make predictions using model
ses.pred <- forecast(ses, h = nValid, level = 0)
# plot predictions
plot(ses.pred, ylab = "Ridership (Twice-Differenced)", xlab = "Time",
bty = "l", xaxt = "n", xlim = c(1991,2013.50), main = "Simple Exponential Smoother on
Double Differenced Data", flty = 2)
# labels
axis(1, at = seq(1991, 2013, 1), labels = format(seq(1991, 2013, 1)))
# validaiton data
lines(valid.ts)
# model from training and validation data
lines(ses.pred$fitted, lwd = 2, col = "blue")
#test the dataset for stationarity if stationary
# no need for differencing if not stationary the data will be differenced.
adf.test
#test the dataset for stationarity if stationary
# no need for differencing if not stationary the data will be differenced.
library(tseries)
adf.test
#test the dataset for stationarity if stationary
# no need for differencing if not stationary the data will be differenced.
library(tseries)
adf.test(df)
setwd("C:/Coding/Monthly-Amtrak-Ridership-Forecasting/Code")
# Load the data set from CSV file
df <- read_csv("~/Coding/Monthly-Amtrak-Ridership-Forecasting/Data/Amtrak Ridership Data.csv")
# Load the data set from CSV file
df <- read_csv("C:/Coding/Monthly-Amtrak-Ridership-Forecasting/Data/Amtrak Ridership Data.csv")
# Rename columns
names(df)[1] <- 'Dates'
names(df[2]) <- 'Number_of_Passengers'
# First 12 months in 1991
head(df, n = 12) %>%
pander(style = "grid", caption = "First 12 Months - 1991")
library(astsa)
library(readr)
library(forecast)
library(zoo)
library(xts)
library(pander)
library(tidyverse)
library(lubridate)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
# Load the data set from CSV file
df <- read_csv("C:/Coding/Monthly-Amtrak-Ridership-Forecasting/Data/Amtrak Ridership Data.csv")
# Rename columns
names(df)[1] <- 'Dates'
names(df[2]) <- 'Number_of_Passengers'
# First 12 months in 1991
head(df, n = 12) %>%
pander(style = "grid", caption = "First 12 Months - 1991")
# convert to time series object
df<- ts(data = df[,2], start = c(1991,1),
end = c(2013,5), frequency = 12)
print("Starting Year and Month: ")
start(df)
print("Final Year and Month: ")
end(df)
# Make a quick time-series plot
plot(df, xlab = "Year", ylab = "Number of Passengers",
bty = "l", col = "grey41",
main = "Amtrak Ridership, 1991-2013")
# Trailing Average
ma.trailing <- rollmean(df, k = 12, align = "right")
# Centered-Average
ma.centered <- ma(df, order = 12)
# Original Data
plot(df, ylab = "Ridership", xlab = "Time",
bty = "l", xaxt = "n", col = 'grey41',
main = "Centered vs. Trailing Moving Average")
# Labels
axis(1, at = seq(1991, 2013.50, 1), labels = format(seq(1991, 2013.50, 1)))
# Centered average lines
lines(ma.centered, lwd = 2, col = 'red')
# trailing moving average
lines(ma.trailing, lwd = 2, lty = 2, col ='blue')
# legend
legend(1991,2800000, c("Ridership","Centered Moving Average",
"Trailing Moving Average"), lty=c(1,1,2),
lwd=c(1,2,2), bty = "n", col = c("grey41", 'red', 'blue'))
# Validation Data
nValid <- 36
# Training data
nTrain <- length(df) - nValid
# time window for training data
train.ts <- window(df, start = c(1991, 1), end = c(1991, nTrain))
# time window for validation data
valid.ts <- window(df, start = c(1991, nTrain + 1), end = c(1991, nTrain + nValid))
# trailing moving average
ma.trailing <- rollmean(train.ts, k = 12, align = "right")
# last trailing moving average
last.ma <- tail(ma.trailing, 1)
# prediction by trailing moving average
ma.trailing.pred <- ts(rep(last.ma, nValid), start = c(1991, nTrain + 1),
end = c(1991, nTrain + nValid), freq = 12)
# plot
plot(train.ts, ylim = c(1300000, 2800000), ylab = "Ridership",
xlab = "Time", bty="l", xaxt = "n", col = 'grey41',
xlim = c(1991,2013.50), main = "Forecasting with Trailing Moving Average")
# labels
axis(1, at = seq(1991, 2013.50, 1), labels = format(seq(1991, 2013.50, 1)))
# training data
lines(ma.trailing, lwd = 2, col = "blue")
# validation data
lines(valid.ts, col = 'blue')
# predictions
lines(ma.trailing.pred, lwd = 2, col = "blue", lty = 2)
par(mfrow=c(2,2))
# Original
plot(df, xlab = "Year", ylab = "Number of Passengers",
main = "Original Amtrak Ridership, 1991-2013", col = 'grey41')
# lag-12 difference
plot(diff(df, lag = 12), xlab = "Year", ylab = "Lag-12",
main = "Lag-12 Difference", col = 'blue')
# lag-1 difference
plot(diff(df), xlab = "Year", ylab = "Lag-1",
main = "Lag-1 Difference", col = 'red')
# Double Differencing
plot(diff(diff(df, s = 12)), xlab = "Year", ylab = "Lag-12, then Lag-1",
main = "Twice-DIfferenced (Lag-12, Lag-1)", col = 1)
# remove trend and seasonality by doing double-differencing
diff_twice <- diff(diff(df, lag = 12), lag = 1)
# Number of validation data
nValid <- 36
# number of training data
nTrain <- length(diff_twice) - nValid
# specified time window for training data
train.ts <- window(diff_twice, start = c(1992, 2), end = c(1992, nTrain + 1))
# specified time window for validation data
valid.ts <- window(diff_twice, start = c(1992, nTrain + 2),
end = c(1992, nTrain + 1 + nValid))
# Additive, no trend, no seasonality model using a constant (learning rate) of 0.2
ses <- ets(train.ts, model = "ANN", alpha = 0.2)
# make predictions using model
ses.pred <- forecast(ses, h = nValid, level = 0)
# plot predictions
plot(ses.pred, ylab = "Ridership (Twice-Differenced)", xlab = "Time",
bty = "l", xaxt = "n", xlim = c(1991,2013.50), main = "Simple Exponential Smoother on
Double Differenced Data", flty = 2)
# labels
axis(1, at = seq(1991, 2013, 1), labels = format(seq(1991, 2013, 1)))
# validaiton data
lines(valid.ts)
# model from training and validation data
lines(ses.pred$fitted, lwd = 2, col = "blue")
